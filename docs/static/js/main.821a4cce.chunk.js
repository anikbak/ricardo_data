(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{355:function(e,t){},365:function(e,t,a){e.exports=a(958)},376:function(e,t,a){},631:function(e,t){},633:function(e,t){},665:function(e,t){},666:function(e,t){},75:function(e){e.exports={b:"https://raw.githubusercontent.com/medialab/ricardo_data/master",a:"https://api.github.com/repos/medialab/ricardo_data/contents"}},791:function(e,t,a){var n={"./geojson.json":316,"./table-schema.json":792,"./topojson.json":317};function r(e){var t=o(e);return a(t)}function o(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=o,e.exports=r,r.id=791},854:function(e,t,a){var n={"./data-package.json":855,"./data-resource.json":856,"./fiscal-data-package.json":857,"./registry.json":858,"./tabular-data-package.json":859,"./tabular-data-resource.json":860};function r(e){var t=o(e);return a(t)}function o(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=o,e.exports=r,r.id=854},925:function(e,t,a){var n={"./geojson.json":350,"./table-schema.json":926,"./topojson.json":351};function r(e){var t=o(e);return a(t)}function o(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=o,e.exports=r,r.id=925},954:function(e,t){},955:function(e,t){},957:function(e,t,a){},958:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(91),i=a.n(o),c=a(26),l=(a(376),a(50)),s=a(51),u=a(53),d=a(52),m=a(54),f=a(10),p=a(131),h=a(75),E=a(93),v="FETCH_DATAPACKAGE_SUCCESS",b="FETCH_TABLES_SUCCESS",y=[{name:"sources",path:"data/sources.csv"},{name:"currencies",path:"data/currencies.csv"},{name:"entity_names",path:"data/entity_names.csv"},{name:"expimp_spegen",path:"data/expimp_spegen.csv"}],g={};var O=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.repoData;e.tables||e.datapackage||(this.props.fetchDatapackage(),this.props.fetchAllTables({branch:"master"}))}},{key:"render",value:function(){var e=this.props.repoData;return r.a.createElement("div",null,!e.tables&&r.a.createElement("span",null,"loading tables"),!e.datapackage&&r.a.createElement("span",null,"loading datapackage"))}}]),t}(r.a.Component),x=Object(c.b)(function(e){return{repoData:e.repoData}},{fetchAllTables:function(e){return function(t){var a=e.branch;t({type:"FETCH_TABLES_REQUEST"}),Promise.all(y.map(function(e){return Object(p.get)("".concat(h.a,"/").concat(e.path,"?ref=").concat(a))})).then(function(e){var a={};e.forEach(function(e){var t=e.data.name.split(".")[0];a[t]=e.data}),t({type:b,payload:a})}).catch(function(a){return t({type:"FETCH_TABLES_FAILURE",payload:e,error:a})})}},fetchDatapackage:function(){return function(e){return e({type:"FETCH_DATAPACKAGE_REQUEST"}),Object(p.get)("".concat(h.a,"/datapackage.json?ref=master")).then(function(t){return e({type:v,payload:t.data})}).catch(function(t){return e({type:"FETCH_DATAPACKAGE_FAILURE",error:t})})}}})(O),j=a(2),w=a(359),k="START_MODIFICATION",N={modificationList:null},C=Object(w.a)(N,{SET_STEP:function(e,t){if("0"===t.payload.id)return N},START_MODIFICATION:function(e,t){var a=t.payload;e.modificationList=a},SUBMIT_MODIFICATION:function(e,t){var a=t.payload;e.modificationList[a.index].fixed=!0}}),S="SET_STEP",_="HIDE_MODIFICATION",R="GO_NEXT_ERROR",T="GO_PREV_ERROR",F="SELECT_ERROR",A=function(e){return{type:S,payload:e}},I=[{id:"0",name:"Upload file",title:"Choose a file"},{id:"1",name:"Schema Validation",title:"Schema validation against datapackage"},{id:"2",name:"Error Fixing",title:"Fix errors by fields"},{id:"3",name:"Export/Publish Data",title:"Export or Publish your data to Github"}],D={steps:I,selectedStep:I[0],isModification:!1,modificationIndex:0,fixedIndex:[]};var L=function(e){var t=e.className,a=e.modificationList,n=e.onSelectError,o=["","Field","Value","Rows",""];return r.a.createElement("div",{style:{position:"relative",width:"100%",height:"70vh"}},r.a.createElement("div",{className:"action-table ".concat(t)},r.a.createElement("div",{className:"action-table-header"},o.map(function(e,t){return r.a.createElement("div",{key:t,className:"table-cell"},r.a.createElement("span",{className:"Value"===e?"has-text-danger":"has-text-black"},e))})),r.a.createElement("div",{className:"action-table-main"},a.map(function(e,t){var a=e.field,i=e.errors,c=function(){n(t)};return r.a.createElement("div",{key:t,className:"table-row"},o.map(function(n,o){switch(o){case 0:default:return r.a.createElement("div",{key:o,className:"table-cell"},t+1);case 1:return r.a.createElement("div",{key:o,className:"table-cell"},a);case 2:return r.a.createElement("div",{key:o,className:"table-cell"},r.a.createElement("span",{className:"has-text-danger"},i[0].value||"null"),r.a.createElement(j.HelpPin,null,i[0].message));case 3:return r.a.createElement("div",{key:o,className:"table-cell"},i.length);case 4:return r.a.createElement("div",{key:o,className:"table-cell"},r.a.createElement(j.Button,{isOutlined:!0,isColor:e.fixed?"success":"info",onClick:c},e.fixed?"fixed":"fix error"))}}))}))))},M=function(e){var t=e.className,a=e.flows,n=e.modificationItem,o=a[0],i=n.errors,c=n.field;return r.a.createElement("div",{style:{position:"relative",width:"100%",height:"20vh"}},r.a.createElement("div",{className:"has-text-danger"},"total ",i.length," rows affected"),r.a.createElement("div",{className:"action-table ".concat(t)},r.a.createElement("div",{className:"action-table-header"},o.map(function(e,t){var a=-1!==c.indexOf(e);return r.a.createElement("div",{key:t,className:"table-cell"},r.a.createElement("span",{className:a?"has-text-danger":"has-text-black"},e))})),r.a.createElement("div",{className:"action-table-main"},i.map(function(e,t){return r.a.createElement("div",{key:t,className:"table-row"},o.map(function(t,n){var o=-1!==c.indexOf(t);return r.a.createElement("div",{key:n,className:"table-cell",style:{wordBreak:"break-all"}},r.a.createElement("span",{className:o?"has-text-danger":"has-text-black"},a[e.rowNumber-1][n]))}))}))))},B=function(e){e.className;var t=e.modificationItem,a=e.schema,n=e.onSubmitForm,o=t.field,i=t.errorType,c=t.value,l=t.message,s=a.fields.find(function(e){return e.name===o});if("ERROR_FOREIGN_KEY"===i){var u=a.foreignKeys.find(function(e){return-1!==e.fields.indexOf(o)});s=Object(f.a)({},s,{foreignKeys:u})}return r.a.createElement("div",{style:{height:"40vh"}},r.a.createElement("form",{style:{width:"20rem",padding:"1rem"}},r.a.createElement("div",null,r.a.createElement("span",{className:"has-text-weight-bold"},s.name),r.a.createElement("span",{style:{display:"inline-block",marginLeft:".5rem",paddingLeft:".5rem",paddingRight:".5rem",background:"white",flex:1}},c)),r.a.createElement(j.Help,{isColor:"danger"},l),(!s.constraints||!s.constraints.enum)&&r.a.createElement(j.Field,null,r.a.createElement(j.Label,null,s.name),r.a.createElement(j.Control,null,r.a.createElement(j.Input,{placeholder:"Text Input",value:""}))),s.constraints&&s.constraints.enum&&r.a.createElement(j.Field,null,r.a.createElement(j.Label,null,"Select value from:"),r.a.createElement(j.Control,null,r.a.createElement(j.Select,null,s.constraints.enum.map(function(e,t){return r.a.createElement("option",{key:t},e)})))),r.a.createElement(j.Field,{isGrouped:!0},r.a.createElement(j.Control,null,r.a.createElement(j.Button,{isColor:"primary",onClick:n},"Submit")))))},V=function(e){e.className;var t=e.flows,a=e.schema,n=e.modificationItem,o=e.modificationIndex,i=e.onSubmitModification;n.errors;return r.a.createElement("div",{style:{height:"70vh"}},r.a.createElement("div",null,r.a.createElement(B,{schema:a,modificationItem:n,onSubmitForm:function(){return i(o)}}),r.a.createElement(M,{flows:t,modificationItem:n})))},U=a(92),P=a(9),H=a.n(P),K=a(132),G=(a(626),a(361),a(191)),W=a(94),Y="UPDATE_FLOW",J="IMPORT_FLOWS",Q={};var z={id:0,flow:1,unit:2,species_bullions:3,transport_type:4,statistical_period:5,partner_sum:6,world_trade_type:7,notes:8,source:9,reporting:10,partner:11,"export_import|special_general":12,"currency|year|reporting":13},X="VALIDATE_TABLE_REQUEST",Z="VALIDATE_TABLE_SUCCESS",$="VALIDATE_TABLE_FAILURE",q="VALIDATE_HEADER_REQUEST",ee="VALIDATE_HEADER_SUCCESS",te="VALIDATE_HEADER_FAILURE",ae=function(e){return"string"===typeof e?e:e.join("|")},ne=function(e,t,a){var n=t.fields,r=t.foreignKeys,o=n.map(function(e){return e.name}),i=function(e){return e.reduce(function(e,t){return"string"===typeof t?e.concat([t]):e.concat(t)},[])}(r.map(function(e){return e.fields})),c=n.filter(function(e){return-1===i.indexOf(e.name)}),l=r.map(function(e){return ae(e.fields)}),s=["ERROR_FORMAT","ERROR_FOREIGN_KEY"],u=c.reduce(function(e,t){return Object(f.a)({},e,Object(U.a)({},t.name,{name:t.name,schema:t,errorType:"ERROR_FORMAT",errors:[]}))},{}),d=r.reduce(function(e,t){var a=ae(t.fields);return Object(f.a)({},e,Object(U.a)({},a,Object(f.a)({name:a},t,{errorType:"ERROR_FOREIGN_KEY",errors:[]})))},{});return a.forEach(function(t){var a=e[t.rowNumber-1],n=t.rowNumber;s.forEach(function(e){var r=t.errors.find(function(t){return t.type===e});r&&("ERROR_FORMAT"===e?o.forEach(function(t,o){r.errors.forEach(function(r){if(r.columnNumber===o+1&&-1===i.indexOf(t)){var c={rowNumber:n,errorType:e,columnNumber:r.columnNumber,field:t,value:a[o]||"null",message:r.message};u[t].errors.push(c)}})}):"ERROR_FOREIGN_KEY"===e&&l.forEach(function(t){r.errors.forEach(function(r){var i=ae(r.columnName);if(i===t){var c=r.columnName.map(function(e){var t=o.indexOf(e);return a[t]}),l={rowNumber:n,errorType:e,columnName:r.columnName,field:i,value:c.join("|"),message:r.message};d[t].errors.push(l)}})}))})}),Object.keys(u).forEach(function(e){u[e].errors.length||delete u[e]}),Object.keys(d).forEach(function(e){d[e].errors.length||delete d[e]}),Object(f.a)({},u,d)},re={tableValidated:"flows",schemaFeedback:null,headerFeedback:null,tables:null};var oe=function(e){var t=e.schemaValidation.tableValidated;return e.schemaValidation.descriptor.resources.find(function(e){return e.name===t}).schema},ie=function(e){var t=ce(e),a={};return t.forEach(function(t){var n=t.reference.resource;a[n]=e.schemaValidation.tables[n]}),a},ce=function(e){var t=e.schemaValidation.tableValidated;return e.schemaValidation.descriptor.resources.find(function(e){return e.name===t}).schema.foreignKeys},le=(a(23),function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.flows,n=t.schema,o=t.isModification,i=t.modificationIndex,c=t.modificationList,l=c.filter(function(e){return!1===e.fixed}),s=function(t){t<c.length&&e.props.selectError({index:t})};return r.a.createElement("div",null,!o&&r.a.createElement("div",null,c.length>0&&r.a.createElement("div",{className:"has-text-danger has-text-weight-bold"},c.length," different errors need to modify"),c&&r.a.createElement(L,{modificationList:c,onSelectError:s}),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement(j.Button,{isColor:"info",onClick:function(){return e.props.setStep({id:"1"})}},"Previous Step"),0===l.length?r.a.createElement(j.Button,{isColor:"info",onClick:function(){return e.props.setStep({id:"3"})}},"Ready to publish"):r.a.createElement(j.Button,{isColor:"info",onClick:function(){e.props.selectError({index:l[0].index})}},"Start fix error"))),o&&r.a.createElement("div",null,r.a.createElement(V,{flows:a,schema:n,modificationIndex:i,modificationItem:c[i],onSubmitModification:function(t){e.props.submitModification({index:t}),t+1<c.length?s(t+1):e.props.hideModification()}}),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement("div",null,r.a.createElement(j.Button,{isColor:"info",onClick:this.props.hideModification},"Back to summary")),r.a.createElement("span",{className:"has-text-danger has-text-weight-bold"},i+1," / ",c.length),r.a.createElement("div",null,0!==i&&r.a.createElement(j.Button,{isColor:"info",style:{marginLeft:"10px"},onClick:function(){i>0&&e.props.goPrevError()}},"Prev Error"),i!==c.length-1&&r.a.createElement(j.Button,{isColor:"info",style:{marginLeft:"10px"},onClick:function(){i<c.length-1&&e.props.goNextError()}},"Next Error")))))}}]),t}(r.a.Component)),se=Object(c.b)(function(e){return{flows:e.flows.data,schema:e.schemaValidation.descriptor&&oe(e),schemaFeedback:e.schemaValidation.schemaFeedback,modificationList:e.modification.modificationList,isModification:e.ui.isModification,modificationIndex:e.ui.modificationIndex}},{setStep:A,hideModification:function(){return{type:_}},selectError:function(e){return{type:F,payload:e}},goNextError:function(){return{type:R}},goPrevError:function(){return{type:T}},submitModification:function(e){return{type:"SUBMIT_MODIFICATION",payload:e}}})(le),ue=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,"github publish")}}]),t}(r.a.Component),de=Object(c.b)(function(e){return{repoData:e.repoData}})(ue),me=a(363),fe=a(34),pe=function(e){var t,a=e.headerNames,n=e.fieldNames,o=a.length-n.length;t=o>0?Object(fe.difference)(a,n):Object(fe.difference)(n,a);var i=a.map(function(e,t){return n[t]&&n[t]===e?{name:e,valid:!0}:{name:e,valid:!1}});return r.a.createElement("div",{style:{}},t.length===o&&o>0&&r.a.createElement("div",{className:"has-text-danger"},r.a.createElement("span",null,"Extra headers - "),t.map(function(e){return r.a.createElement("span",null,'"',e,'" ')})),t.length===Math.abs(o)&&o<0&&r.a.createElement("div",{className:"has-text-danger has-text-weight-bold"},r.a.createElement("span",null,"Missing headers - "),t.map(function(e){return r.a.createElement("span",null,'"',e,'" ')})),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-evenly"}},r.a.createElement("div",null,r.a.createElement("div",{className:"has-text-weight-bold"},"headers "),i.map(function(e,t){return r.a.createElement("div",{key:t,className:e.valid?"has-text-black":"has-text-danger"},e.name)})),r.a.createElement("div",null,r.a.createElement("div",{className:"has-text-weight-bold"},"schema fields"),n.map(function(e,t){return r.a.createElement("div",{key:t},e)}))))},he=a(192),Ee=a.n(he);var ve=Object(c.b)(function(e){return{schema:e.schemaValidation.descriptor&&oe(e),flows:e.flows,headerFeedback:e.schemaValidation.headerFeedback}},{importFlows:function(e){return{type:J,payload:e}},setStep:A,validateHeader:function(e){return function(t){var a=e.source,n=e.schema;t({type:q,payload:Object(f.a)({},e,{status:"loading"})}),t(Object(K.a)(H.a.mark(function e(){var r;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,G.Table.load(a.slice(0,2),{schema:n});case 3:return r=e.sent,e.next=6,r.read({limit:1});case 6:t({type:ee,payload:{status:"done",valid:!0,headers:r.headers}}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0),"ERROR_HEADER"!==e.t0.type?t({type:ee,payload:{status:"done",valid:!0,headers:r.headers}}):t({type:te,valid:!1,status:"done",payload:e.t0});case 13:case"end":return e.stop()}},e,null,[[0,9]])})))}}})(function(e){var t=e.schema,a=e.flows,n=e.headerFeedback,o=e.setStep,i=e.importFlows,c=e.validateHeader;return r.a.createElement("div",null,r.a.createElement(j.DropZone,{maxSize:1e7,onDrop:function(e){var a=Object(me.a)(e,1)[0];"xlsx"===a.name.split(".")[1]?function(e){return new Promise(function(t,a){var n=new FileReader;n.onload=function(e){var a=e.target.result,r=Ee.a.read(a,{type:"binary"}),o=r.SheetNames[0],i=r.Sheets[o],c=Ee.a.utils.sheet_to_json(i,{header:1,defval:"",blankrows:!1});t(c),n=void 0},n.onerror=function(e){a(e.target.error),n=void 0},n.readAsBinaryString(e)})}(a).then(function(e){i({file:{name:a.name},data:e}),c({source:e,schema:t})}).catch(function(e){return console.error("fail to parse file")}):function(e){return new Promise(function(t,a){var n=new FileReader;return n.onload=function(a){var r;r="csv"===e.name.split(".")[1]?Object(W.b)(a.target.result):Object(W.c)(a.target.result),t(r),n=void 0},n.onerror=function(e){a(e.target.error),n=void 0},n.readAsText(e)})}(a).then(function(e){i({file:{name:a.name},data:e}),c({source:e,schema:t})}).catch(function(e){return console.error("fail to parse file")})},onDropRejected:function(e,t){console.log("file is invalid")},isSize:"small"},r.a.createElement("span",{className:"tech-info"},"Drag and drop .xlsx, .csv file here(maximum 10MB)")),n&&"loading"===n.status&&r.a.createElement("span",null,"Validating Headers"),n&&n.valid&&r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement("span",{className:"has-text-success has-text-weight-bold"},'Headers of "',a.file.name,'" are valid'),r.a.createElement(j.Button,{isColor:"info",onClick:function(){return o({id:"1"})}},"Next Step")),n&&!n.valid&&"ERROR_HEADER"===n.type&&r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement("span",{className:"has-text-danger has-text-weight-bold"},'Headers of "',a.file.name,'" do not match schema fields, please fix your file and re-upload'),r.a.createElement(pe,{headerNames:n.headerNames,fieldNames:n.fieldNames})))}),be=function(e){var t=e.className,a=e.collectedErrors,n=["Field","Error Type","Error Overview"],o=Object(fe.sortBy)(a,function(e){return z[e.name]});return r.a.createElement("div",{style:{position:"relative",width:"100%",height:"70vh"}},r.a.createElement("div",{className:"action-table ".concat(t)},r.a.createElement("div",{className:"action-table-header"},n.map(function(e,t){return r.a.createElement("div",{key:t,className:"table-cell"},e)})),r.a.createElement("div",{className:"action-table-main"},o.map(function(e,t){var a=e.errors.length,o=Object(fe.groupBy)(e.errors,function(e){return e.value}),i=Object.keys(o).length;return r.a.createElement("div",{key:t,className:"table-row"},n.map(function(t,n){var o;return o=0===n?e.name:1===n?e.errorType:"".concat(a," rows affected in total, ").concat(i," different invalid values"),r.a.createElement("div",{key:n,className:"table-cell"},o)}))}))))},ye=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.flows,a=e.schema,n=e.relations;e.schemaFeedback||this.props.validateTable({source:t,schema:a,relations:n})}},{key:"render",value:function(){var e=this,t=this.props,a=t.schemaFeedback,n=t.modificationList,o=/row\s\d*/;return r.a.createElement("div",null,a&&"loading"===a.status&&r.a.createElement("span",null,a.loader),a&&!a.valid&&a.collectedErrors&&r.a.createElement("div",null,r.a.createElement("span",{className:"has-text-danger has-text-weight-bold"},"Found errors in ",a.errors.length," rows of ",Object.keys(a.collectedErrors).length," fields"),r.a.createElement(be,{collectedErrors:a.collectedErrors}),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement(j.Button,{isColor:"info",onClick:function(){return e.props.setStep({id:"0"})}},"Previous Step"),r.a.createElement(j.Button,{isColor:"info",onClick:function(){if(!n){var t=function(e){var t=Object(fe.values)(e).reduce(function(e,t){return e.concat(t.errors)},[]),a=Object(fe.values)(Object(fe.groupBy)(t,function(e){return e.field+e.value})).map(function(e,t){return{index:t,field:e[0].field,errorType:e[0].errorType,fixed:!1,message:e[0].message.replace(o,"".concat(e.length," rows")),value:e[0].value,errors:e}});return Object(fe.sortBy)(a,function(e){return z[e.name]})}(a.collectedErrors);e.props.startModification(t)}e.props.setStep({id:"2"})}},"Review Errors"))),a&&a.valid&&r.a.createElement("span",{className:"has-text-success has-text-weight-bold"},"Flows data is valid"))}}]),t}(r.a.Component),ge=Object(c.b)(function(e){return{flows:e.flows.data,schema:e.schemaValidation.descriptor&&oe(e),relations:e.schemaValidation.descriptor&&ie(e),foreignKeys:e.schemaValidation.descriptor&&ce(e),schemaFeedback:e.schemaValidation.schemaFeedback,modificationList:e.modification.modificationList}},{validateTable:function(e){return function(t){var a=e.source,n=e.schema,r=e.relations;t(Object(K.a)(H.a.mark(function e(){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.delegateYield(H.a.mark(function e(){var o,i,c,l,s;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=a.length,i=100,c=0,l=[],s=H.a.mark(function e(){var o,s,u,d,m;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:X,payload:{status:"loading",loader:"validating ".concat(c," rows")}}),o=c/i,s=[a[0]].concat(a.slice(c+1-o,c+i-o)),e.next=5,G.Table.load(s,{schema:n});case 5:return u=e.sent,e.next=8,u.read({forceCast:!0,relations:r});case 8:d=e.sent,(m=d.filter(function(e){return e.errors})).length&&(m.forEach(function(e){e.rowNumber=e.rowNumber+i*o-o}),l=l.concat(m));case 11:case"end":return e.stop()}},e)});case 6:if(!(c<o)){e.next=11;break}return e.delegateYield(s(),"t0",8);case 8:c+=i,e.next=6;break;case 11:l.length?t({type:$,payload:{status:"done",valid:!1,errors:l,collectedErrors:ne(a,n,l)}}):t({type:Z,payload:{status:"done",valid:!0}});case 12:case"end":return e.stop()}},e)})(),"t0",2);case 2:e.next=8;break;case 4:e.prev=4,e.t1=e.catch(0),console.error(e.t1),t({type:$,payload:e.t1});case 8:case"end":return e.stop()}},e,null,[[0,4]])})))}},setStep:A,startModification:function(e){return{type:k,payload:e}}})(ye),Oe=function(e){var t=e.steps,a=e.selectedStep,n=e.onSetStep,o=e.children;return r.a.createElement(j.LayoutWrapper,{hasConfig:!0},r.a.createElement(j.LayoutHeader,null,r.a.createElement(j.AppTitle,null,"Ricardo Data App"),r.a.createElement(j.RunningTitle,null,a.title)),r.a.createElement(j.LayoutContainer,null,r.a.createElement(j.LayoutContent,null,r.a.createElement(j.LayoutContentColumn,{isConfig:!0},t.map(function(e,t){var o=a.id===e.id,i=e.id>a.id;return r.a.createElement(j.ButtonContainer,{key:t},r.a.createElement(j.Button,{isColor:o?"info":null,isDisabled:i,onClick:function(){return n(e)}},e.name))})),r.a.createElement(j.LayoutContentColumn,{isWorkspace:!0},o)),r.a.createElement(j.LayoutFooter,null,r.a.createElement(j.LayoutFooterColumn,{isSecondary:!0},r.a.createElement("h3",null,"m\xe9dialab SciencesPo")),r.a.createElement(j.LayoutFooterColumn,{isPrimary:!0},"Ricardo Data App"))))},xe=(a(956),a(957),Object(c.b)(function(e){return{steps:e.ui.steps,selectedStep:e.ui.selectedStep,repoData:e.repoData}},{setStep:A})(function(e){var t=e.steps,a=e.selectedStep,n=e.repoData,o=e.setStep;return r.a.createElement("div",{className:"App"},r.a.createElement(x,null),n.descriptor&&r.a.createElement(Oe,{steps:t,selectedStep:a,onSetStep:o},function(){switch(a.id){case"0":default:return r.a.createElement(ve,null);case"1":return r.a.createElement(ge,null);case"2":return r.a.createElement(se,null);case"3":return r.a.createElement(de,null)}}()))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var je=a(17),we=a(193),ke=a(362),Ne=a(130),Ce=Object(je.combineReducers)({ui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0,a=t.payload;switch(t.type){case S:return Object(f.a)({},D,{selectedStep:I.find(function(e){return a.id===e.id})});case k:return Object(f.a)({},e,{isModification:!0,modificationIndex:0});case _:return Object(f.a)({},e,{isModification:!1,modificationIndex:0});case F:return Object(f.a)({},e,{isModification:!0,modificationIndex:a.index});case R:return Object(f.a)({},e,{modificationIndex:e.modificationIndex+1});case T:if(0===e.modificationIndex)return;return Object(f.a)({},e,{modificationIndex:e.modificationIndex-1});default:return e}},flows:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0,a=t.payload;switch(t.type){case S:return"0"===a.id?Q:e;case J:return a;case Y:return Object(f.a)({},e,{data:a.data});default:return e}},schemaValidation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0,a=t.payload;switch(t.type){case S:return"0"===a.id?Object(f.a)({},e,{schemaFeedback:null,headerFeedback:null}):e;case b:var n={};return Object.keys(a).forEach(function(e){n[e]=Object(W.a)(E.Base64.decode(a[e].content),function(e){return e.year?Object(f.a)({},e,{year:+e.year}):e})}),Object(f.a)({},e,{tables:n});case v:return Object(f.a)({},e,{descriptor:JSON.parse(E.Base64.decode(a.content))});case q:case te:case ee:return Object(f.a)({},e,{headerFeedback:a});case X:case $:case Z:return Object(f.a)({},e,{schemaFeedback:a});default:return e}},modification:C,repoData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0,a=t.payload;switch(t.type){case b:return Object(f.a)({},e,{tables:a});case v:return Object(f.a)({},e,{datapackage:a,descriptor:JSON.parse(E.Base64.decode(a.content))});default:return e}}}),Se={key:"root",storage:ke},_e=Object(we.a)(Se,Ce);var Re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[Ne.a],a=je.compose.apply(void 0,[je.applyMiddleware.apply(void 0,t)].concat([])),n=Object(je.createStore)(_e,e,a);return{store:n,persistor:Object(we.b)(n)}}({}).store;i.a.render(r.a.createElement(c.a,{store:Re},r.a.createElement(xe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[365,1,2]]]);
//# sourceMappingURL=main.821a4cce.chunk.js.map